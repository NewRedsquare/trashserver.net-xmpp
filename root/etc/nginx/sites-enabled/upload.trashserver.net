server {
	listen 5.1.92.251:80;
	listen 5.1.92.251:443 http2 ssl;
	listen [2a01:360:50e:1::251]:80;
	listen [2a01:360:50e:1::251]:443 http2 ssl;

	server_name upload.trashserver.net;

	ssl_certificate /etc/acme.sh/trashserver.net/fullchain.pem;
	ssl_certificate_key /etc/acme.sh/trashserver.net/privkey.pem;

	client_max_body_size 100m;

	location /upload/ {
		if ( $request_method = OPTIONS ) {
			add_header Access-Control-Allow-Origin '*';
                        add_header Access-Control-Allow-Methods 'PUT, GET, OPTIONS, HEAD';
			add_header Access-Control-Allow-Headers 'Authorization, Content-Type';
			add_header Access-Control-Allow-Credentials 'true';
			add_header Content-Length 0;
			add_header Content-Type text/plain;
			return 200;
                }

		proxy_pass http://localhost:5050/upload/;
		proxy_request_buffering off;		
	}

	include snippets/tls-common.conf;
}
